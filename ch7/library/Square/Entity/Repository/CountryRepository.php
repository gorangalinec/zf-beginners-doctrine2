<?php

namespace Square\Entity\Repository;

use Doctrine\ORM\EntityRepository;

/**
 * CountryRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class CountryRepository extends EntityRepository {
    
    /*
    protected static $countries = array();
    */
    // Array of countries['code'] and countries['name']
    protected static $countries = array();
    protected static $country_names = array();
    
   
    
    public function getAllCountries()
    {
      /*
      Technique 1: $this->findAll() wouldd return fully-populated objects since Country contains no other object associations.
      */

      // Technique 2: change to use array hydration. Since we are only retrieving selected properties, 
      // an array is returned.
      if (empty(self::$countries)) {
          
           self::$countries = $this->findAll(); 
      }
                
      return self::$countries;
    }

    // In case a country ceases to exist.     
    public function removeCountry($id)
    {
        $em    = $this->getEntityManager();
        $proxy = $em->getReference('\Square\Entity\Country', $id);

        $em->remove($proxy);
    }
}
